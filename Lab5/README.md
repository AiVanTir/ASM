# Лабораторная работа №5 — Выделение границ (Вариант №34)

**Задача.** Реализовать выделение границ на изображении свёрткой 3×3 с матрицей
```
-1 -1 -1
-1  8 -1
-1 -1 -1
```
Граничные условия — **дополнение копированием краёв** (replicate padding).

---

## Формат входных и выходных данных

- Вход: изображение **BMP** (любой 24‑битный/8‑битный BMP). При чтении конвертируется в 8‑битное градации серого.
- Выход: изображение **BMP** (8‑битное, 1 канал).

Для работы с файлами используются `stb_image.h` и `stb_image_write.h` (в репозитории).

---

## Структура проекта

```
.
├── main.c            # запуск, выбор режима (C/ASM), ввод/вывод BMP
├── edge_c.c/.h       # реализация фильтра на C
├── edge_asm.asm      # реализация фильтра на NASM x86-64
├── image_io.c/.h     # загрузка BMP → grayscale, сохранение grayscale → BMP
├── stb_image.h       # библиотека чтения изображений
├── stb_image_write.h # библиотека записи изображений
└── Makefile
```

---

## Сборка

Требуется Linux x86‑64, `gcc`, `nasm`.

```bash
make
```

---

## Запуск

```
./main <input.bmp> <output.bmp> <mode>
# <mode> = c | asm
```

Пример:
```bash
./main lena.bmp edges.bmp asm
```

---

## Примечания по реализации

- В C‑версии и ASM‑версии используется одна и та же маска 3×3 и **репликация краёв**.
- Чтение: `stbi_load(..., /*req_comp=*/1)` — получение 8‑битного монохромного буфера.
- Запись: `stbi_write_bmp(..., comp=1, data)` — сохранение 8‑битного BMP.

---

## Проверка работоспособности

1. Соберите проект: `make`.
2. Возьмите тестовое BMP‑изображение (например, `lena.bmp`).
3. Запустите C‑реализацию:
   ```bash
   ./main lena.bmp out_c.bmp c
   ```
4. Запустите ASM‑реализацию:
   ```bash
   ./main lena.bmp out_asm.bmp asm
   ```
5. Откройте `out_c.bmp` и `out_asm.bmp` — результат должен соответствовать выделению границ.
